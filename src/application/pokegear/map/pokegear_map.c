#include "global.h"

#include "constants/maps.h"

#include "application/pokegear/map/pokegear_map_internal.h"
#include "msgdata/msg/msg_0273.h"

#include "brightness.h"
#include "phonebook_dat.h"
#include "pokegear_apps.h"
#include "roamer.h"
#include "sound_02004A44.h"
#include "sys_flags.h"
#include "touchscreen.h"
#include "unk_02005D10.h"
#include "unk_0200FA24.h"

FS_EXTERN_OVERLAY(OVY_26);

BOOL ov101_021E7874(u16 mapID);
BOOL ov101_021E78B0(u16 mapID);
void ov101_021E78EC(PokegearMapAppData *mapApp);
void ov101_021E7B54(PokegearMapAppData *mapApp);
int ov101_021E7B90(PokegearMapAppData *mapApp);
int ov101_021E7BB4(PokegearMapAppData *mapApp);
int ov101_021E7C10(PokegearMapAppData *mapApp);
int ov101_021E7C38(PokegearMapAppData *mapApp);
int ov101_021E7C4C(PokegearMapAppData *mapApp);
int ov101_021E7D28(PokegearMapAppData *mapApp);
int ov101_021E7D3C(PokegearMapAppData *mapApp);
int ov101_021E7D50(PokegearMapAppData *mapApp);
int ov101_021E7E28(PokegearMapAppData *mapApp);
int ov101_021E7E98(PokegearMapAppData *mapApp);
int ov101_021E7F20(PokegearMapAppData *mapApp);

static const u16 ov101_021F7358[] = {
    26, 29, 45
};

BOOL PokegearMap_Init(OverlayManager *man, int *state) {
    PokegearAppData *pokegearApp = OverlayManager_GetArgs(man);
    HandleLoadOverlay(FS_OVERLAY_ID(OVY_26), OVY_LOAD_ASYNC);
    CreateHeap(HEAP_ID_3, HEAP_ID_POKEGEAR_APP, 0x30000);
    PokegearMapAppData *mapApp = OverlayManager_CreateAndGetData(man, sizeof(PokegearMapAppData), HEAP_ID_POKEGEAR_APP);
    memset(mapApp, 0, sizeof(PokegearMapAppData));
    mapApp->pokegear = pokegearApp;
    mapApp->heapId = HEAP_ID_POKEGEAR_APP;
    ov101_021E78EC(mapApp);
    mapApp->unk_214 = ov101_021F7372;
    mapApp->unk_136 = 100;
    return TRUE;
}

BOOL PokegearMap_Main(OverlayManager *man, int *state) {
    PokegearMapAppData *mapApp = OverlayManager_GetData(man);

    switch (*state) {
    case 0:
        *state = ov101_021E7B90(mapApp);
        break;
    case 1:
        *state = ov101_021E7BB4(mapApp);
        break;
    case 2:
        *state = ov101_021E7C10(mapApp);
        break;
    case 4:
        *state = ov101_021E7D50(mapApp);
        break;
    case 5:
        *state = ov101_021E7E28(mapApp);
        break;
    case 6:
        *state = ov101_021E7E98(mapApp);
        break;
    case 7:
        *state = ov101_021E7F20(mapApp);
        break;
    case 8:
        *state = ov101_021E7C38(mapApp);
        break;
    case 9:
        *state = ov101_021E7C4C(mapApp);
        break;
    case 10:
        *state = ov101_021E7D28(mapApp);
        break;
    case 11:
        *state = ov101_021E7D3C(mapApp);
        break;
    case 13:
        return TRUE;
    }

    return FALSE;
}

BOOL PokegearMap_Exit(OverlayManager *man, int *state) {
    HeapID heapID;
    PokegearMapAppData *mapApp = OverlayManager_GetData(man);

    ov101_021E7B54(mapApp);
    MapMatrix_MapData_Free(mapApp->unk_038);
    if (mapApp->pokegear->appReturnCode != GEAR_RETURN_CANCEL) {
        mapApp->pokegear->isSwitchApp = TRUE;
    }
    heapID = mapApp->heapId;
    OverlayManager_FreeData(man);
    DestroyHeap(heapID);
    UnloadOverlayByID(FS_OVERLAY_ID(OVY_26));
    return TRUE;
}

BOOL ov101_021E7874(u16 mapID) {
    const u16 ov101_021F735E[] = {
        MAP_SINJOH_RUINS_EXTERIOR,
        MAP_SINJOH_RUINS_MYSTRI_STAGE,
        MAP_SINJOH_RUINS_CABIN,
    };

    int i;
    for (i = 0; i < NELEMS(ov101_021F735E); ++i) {
        if (mapID == ov101_021F735E[i]) {
            return TRUE;
        }
    }

    return FALSE;
}

BOOL ov101_021E78B0(u16 mapID) {
    const u16 ov101_021F7364[] = {
        MAP_SS_AQUA_1F,
        MAP_SS_AQUA_CAPTAIN_ROOM,
        MAP_SS_AQUA_1F_SOUTHEAST_ROOMS,
        MAP_SS_AQUA_1F_SOUTHWEST_ROOMS,
        MAP_SS_AQUA_1F_NORTHEAST_ROOMS,
        MAP_SS_AQUA_1F_NORTHWEST_ROOMS,
        MAP_SS_AQUA_B1F,
    };

    int i;
    for (i = 0; i < NELEMS(ov101_021F7364); ++i) {
        if (mapID == ov101_021F7364[i]) {
            return TRUE;
        }
    }

    return FALSE;
}

void ov101_021E78EC(PokegearMapAppData *mapApp) {
    int i;
    PokegearMapAppData_Sub218 *r0;
    RoamerSaveData *roamers;

    mapApp->pokegear->childAppdata = mapApp;
    mapApp->pokegear->reselectAppCB = ov101_021EB338;
    mapApp->pokegear->unknownCB = ov101_021EB2FC;
    ov101_021ED4E0(mapApp);
    if (mapApp->pokegear->app != GEAR_APP_CANCEL) {
        mapApp->unk_00C = 0;
        mapApp->pokegear->app = GEAR_APP_MAP;
        mapApp->unk_138_0 = sub_0202EEA4(mapApp->pokegear->savePokegear);
    } else {
        mapApp->unk_00C = 1;
        mapApp->unk_014 = mapApp->pokegear->unk_03C;
        mapApp->unk_138_0 = mapApp->unk_014.unk_01;
        if (mapApp->unk_014.unk_1A != EC_WORD_NULL) {
            r0 = ov101_021ED614(mapApp, mapApp->unk_014.unk_18);
            if (r0 == 0) {
                r0 = ov101_021ED64C(mapApp, mapApp->unk_014.unk_18);
            }
            ov101_021ED79C(r0, mapApp->unk_014.unk_02, mapApp->unk_014.unk_1A);
        }
        mapApp->pokegear->unk_038 = 0;
        mapApp->pokegear->app = GEAR_APP_MAP;
    }
    mapApp->unk_138_4 = FALSE;
    mapApp->unk_138_1 = 0;
    mapApp->unk_138_5 = Pokegear_GetMapUnlockLevel(mapApp->pokegear->savePokegear);
    mapApp->unk_038 = MapMatrix_MapData_New(mapApp->heapId);
    mapApp->unk_124 = SaveData_GetPhoneCallPersistentState(mapApp->pokegear->saveData);
    mapApp->unk_128 = AllocAndReadPhoneBook(mapApp->heapId);
    mapApp->unk_12C = SavePokegear_AllocAndCopyPhonebook(mapApp->pokegear->savePokegear, mapApp->heapId);
    mapApp->unk_130 = SavePokegear_FindEmptyPhonebookSlot(mapApp->pokegear->savePokegear);
    mapApp->unk_108 = mapApp->pokegear->args->matrixXCoord;
    mapApp->unk_10A = mapApp->pokegear->args->matrixYCoord + 2;
    mapApp->unk_10C = mapApp->pokegear->args->mapID;
    mapApp->unk_10E = mapApp->pokegear->args->playerGender;
    mapApp->unk_110 = mapApp->pokegear->args->matrixXCoord;
    mapApp->unk_112 = mapApp->pokegear->args->matrixYCoord + 2;
    mapApp->unk_100 = 1;
    mapApp->unk_104 = 1;
    mapApp->unk_102 = ov101_021F7358[mapApp->unk_138_5];
    mapApp->unk_106 = 0x11;
    mapApp->unk_131 = 8;
    mapApp->unk_132 = 8;
    mapApp->unk_133 = 0;
    mapApp->unk_13D_1 = TRUE;
    mapApp->unk_13D_0 = Save_VarsFlags_FlypointFlagAction(mapApp->pokegear->saveVarsFlags, FLAG_ACTION_CHECK, FLYPOINT_GOLDENROD);
    mapApp->unk_13D_2 = ov101_021E7874(mapApp->unk_10C);
    mapApp->unk_13D_3 = ov101_021E78B0(mapApp->unk_10C);

    roamers = Save_Roamers_Get(mapApp->pokegear->saveData);
    for (i = 0; i < ROAMER_MAX; ++i) {
        if (GetRoamerIsActiveByIndex(roamers, i)) {
            mapApp->unk_9E8[i] = GetRoamerData(Roamers_GetRoamMonStats(roamers, i), ROAMER_DATA_MET_LOCATION);
        } else {
            mapApp->unk_9E8[i] = SPECIES_NONE;
        }
    }
}

void ov101_021E7B54(PokegearMapAppData *mapApp) {
    FreeToHeap(mapApp->unk_12C);
    FreePhoneBook(mapApp->unk_128);
    mapApp->pokegear->reselectAppCB = NULL;
    mapApp->pokegear->unknownCB = NULL;
    ov101_021ED5AC(mapApp);
    sub_0202EEA8(mapApp->pokegear->savePokegear, mapApp->unk_138_0);
}

int ov101_021E7B90(PokegearMapAppData *mapApp) {
    if (!ov101_021E7FF4(mapApp)) {
        return 0;
    }
    if (mapApp->pokegear->isSwitchApp) {
        return 6;
    } else {
        return 4;
    }
}

int ov101_021E7BB4(PokegearMapAppData *mapApp) {
    BOOL isTouch = FALSE;
    int input;

    input = ov101_021EB5DC(mapApp, &isTouch);
    if (!isTouch) {
        PokegearApp_HandleInputModeChangeToButtons(mapApp->pokegear);
        if (mapApp->pokegear->cursorInAppSwitchZone == TRUE) {
            input = PokegearApp_HandleKeyInput_SwitchApps(mapApp->pokegear);
        } else {
            input = ov101_021EB568(mapApp);
        }
    }
    mapApp->pokegear->appReturnCode = input;
    switch (input) {
    case TOUCH_MENU_NO_INPUT:
        break;
    case GEAR_RETURN_7:
        return 8;
    case GEAR_RETURN_4:
        return 5;
    default:
        return 7;
    }

    return 1;
}

int ov101_021E7C10(PokegearMapAppData *mapApp) {
    if (!ov101_021E8070(mapApp)) {
        return 2;
    }
    mapApp->pokegear->unk_03C = mapApp->unk_014;
    return 13;
}

int ov101_021E7C38(PokegearMapAppData *mapApp) {
    if (ov101_021E80B4(mapApp)) {
        return 9;
    } else {
        return 8;
    }
}

int ov101_021E7C4C(PokegearMapAppData *mapApp) {
    int r4 = -1;
    BOOL sp0 = FALSE;

    switch (mapApp->unk_13C_0) {
    case 0:
        r4 = ov101_021ECC58(mapApp, &sp0);
        break;
    case 1:
        if (mapApp->pokegear->menuInputState != MENU_INPUT_STATE_BUTTONS) {
            r4 = ov101_021ECF98(mapApp);
            sp0 = TRUE;
        }
        break;
    case 2:
        if (mapApp->pokegear->menuInputState != MENU_INPUT_STATE_BUTTONS) {
            r4 = ov101_021ED2C0(mapApp);
            sp0 = TRUE;
        }
        break;
    }
    if (sp0) {
        if (mapApp->pokegear->menuInputState != MENU_INPUT_STATE_TOUCH) {
            ov101_021EB364(mapApp);
        }
        mapApp->pokegear->menuInputState = MENU_INPUT_STATE_TOUCH;
        if (r4 >= 0) {
            return r4;
        } else {
            return 9;
        }
    }
    if (PokegearApp_HandleInputModeChangeToButtons(mapApp->pokegear) && mapApp->pokegear->menuInputState != mapApp->pokegear->menuInputStateBak) {
        ov101_021EB378(mapApp);
        PlaySE(SEQ_SE_GS_GEARCURSOR);
        return 9;
    }

    switch (mapApp->unk_13C_0) {
    case 0:
        r4 = ov101_021ECAF0(mapApp);
        break;
    case 1:
        r4 = ov101_021ECEA8(mapApp);
        break;
    case 2:
        r4 = ov101_021ED158(mapApp);
        break;
    }
    if (r4 < 0) {
        r4 = 9;
    }
    return r4;
}

int ov101_021E7D28(PokegearMapAppData *mapApp) {
    if (ov101_021E818C(mapApp)) {
        return 1;
    } else {
        return 10;
    }
}

int ov101_021E7D3C(PokegearMapAppData *mapApp) {
    mapApp->pokegear->isSwitchApp = FALSE;
    mapApp->pokegear->appReturnCode = GEAR_RETURN_CANCEL;
    return 5;
}

int ov101_021E7D50(PokegearMapAppData *mapApp) {
    int i;

    switch (mapApp->state) {
    case 0:
        BeginNormalPaletteFade(0, 1, 1, RGB_BLACK, 6, 1, mapApp->heapId);
        if (mapApp->unk_00C == 1) {
            for (i = 0; i < 4; ++i) {
                ToggleBgLayer(i + GF_BG_LYR_MAIN_1, TRUE);
            }
        } else {
            for (i = 0; i < 8; ++i) {
                ToggleBgLayer(i, TRUE);
            }
        }
        PaletteData_SetAutoTransparent(mapApp->pokegear->plttData, TRUE);
        PaletteData_BlendPalette(mapApp->pokegear->plttData, PLTTBUF_MAIN_BG, 0, 0xE0, 0, 0);
        PaletteData_BlendPalette(mapApp->pokegear->plttData, PLTTBUF_MAIN_OBJ, 0x40, 0xC0, 0, 0);
        PaletteData_PushTransparentBuffers(mapApp->pokegear->plttData);
        PaletteData_SetAutoTransparent(mapApp->pokegear->plttData, FALSE);
        GfGfx_EngineATogglePlanes(GX_PLANEMASK_OBJ, TRUE);
        GfGfx_EngineBTogglePlanes(GX_PLANEMASK_OBJ, TRUE);
        ++mapApp->state;
        break;
    case 1:
        if (IsPaletteFadeFinished()) {
            mapApp->state = 0;
            if (mapApp->unk_00C == 1) {
                return 9;
            } else {
                return 1;
            }
        }
        break;
    }

    return 4;
}

int ov101_021E7E28(PokegearMapAppData *mapApp) {
    switch (mapApp->state) {
    case 0:
        BeginNormalPaletteFade(0, 0, 0, RGB_BLACK, 6, 1, mapApp->heapId);
        ++mapApp->state;
        break;
    case 1:
        if (IsPaletteFadeFinished()) {
            for (int i = 0; i < 8; ++i) {
                ToggleBgLayer(i, FALSE);
            }
            GfGfx_EngineATogglePlanes(GX_PLANEMASK_OBJ, GF_PLANE_TOGGLE_OFF);
            GfGfx_EngineBTogglePlanes(GX_PLANEMASK_OBJ, GF_PLANE_TOGGLE_OFF);
            mapApp->state = 0;
            return 2;
        }
        break;
    }

    return 5;
}

int ov101_021E7E98(PokegearMapAppData *mapApp) {
    BOOL r4;
    BOOL r0;

    switch (mapApp->state) {
    case 0:
        PaletteData_SetAutoTransparent(mapApp->pokegear->plttData, TRUE);
        mapApp->unk_135 = 0;
        for (int i = 0; i < 3; ++i) {
            ToggleBgLayer(i + GF_BG_LYR_MAIN_1, TRUE);
        }
        SetBlendBrightness(0, (GXBlendPlaneMask)(GX_BLEND_PLANEMASK_BG1 | GX_BLEND_PLANEMASK_BG2 | GX_BLEND_PLANEMASK_BG3), SCREEN_MASK_MAIN);
        ++mapApp->state;
        break;
    case 1:
        r4 = ov101_021E9CD4(mapApp, 0);
        r0 = ov101_021E9E90(mapApp, 0);
        if (r4 && r0) {
            ++mapApp->state;
        }
        break;
    case 2:
        PaletteData_SetAutoTransparent(mapApp->pokegear->plttData, FALSE);
        mapApp->state = 0;
        mapApp->unk_030 = 0;
        return 1;
    }

    return 6;
}

int ov101_021E7F20(PokegearMapAppData *mapApp) {
    int i;
    BOOL r4;
    BOOL r0;

    switch (mapApp->state) {
    case 0:
        PaletteData_SetAutoTransparent(mapApp->pokegear->plttData, TRUE);
        for (i = 0; i < 3; ++i) {
            ToggleBgLayer(i + GF_BG_LYR_MAIN_1, TRUE);
        }
        ov101_021E9D74(mapApp, 1);
        mapApp->unk_135 = 0;
        ++mapApp->state;
        break;
    case 1:
        r4 = ov101_021E9CD4(mapApp, 1);
        r0 = ov101_021E9E90(mapApp, 1);
        if (r4 && r0) {
            ++mapApp->state;
        }
        break;
    case 2:
        PaletteData_BlendPalette(mapApp->pokegear->plttData, PLTTBUF_MAIN_BG, 0, 0xE0, 16, 0);
        PaletteData_BlendPalette(mapApp->pokegear->plttData, PLTTBUF_MAIN_OBJ, 0x40, 0xC0, 16, 0);
        PaletteData_PushTransparentBuffers(mapApp->pokegear->plttData);
        for (int i = 0; i < 3; ++i) {
            ToggleBgLayer(i + GF_BG_LYR_MAIN_1, FALSE);
        }
        PaletteData_SetAutoTransparent(mapApp->pokegear->plttData, FALSE);
        mapApp->state = 0;
        mapApp->unk_030 = 0;
        return 2;
    }

    return 7;
}

const PokegearMapAppData_Sub214 ov101_021F7372[] = {
    { MAP_SINJOH_RUINS_EXTERIOR,       0x13, 0x02, 0x3, 0x3, 0x0, 0xC, msg_0273_00065, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
    { MAP_SS_AQUA_1F,                  0x18, 0x10, 0x3, 0x3, 0x0, 0xC, msg_0273_00069, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
    { MAP_ICE_PATH_1F,                 0x15, 0x06, 0x1, 0x1, 0x0, 0x0, msg_0273_00055, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_DARK_CAVE_ROUTE_45_SIDE,     0x11, 0x0A, 0x1, 0x1, 0x0, 0x0, msg_0273_00058, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x28, 0x01, 0x01 },
    { MAP_DARK_CAVE_ROUTE_45_SIDE,     0x13, 0x0C, 0x1, 0x1, 0x0, 0x0, msg_0273_00058, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x2C, 0x01, 0x01 },
    { MAP_DARK_CAVE_ROUTE_45_SIDE,     0x14, 0x08, 0x1, 0x1, 0x0, 0x0, msg_0273_00058, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0D, 0x28, 0x01, 0x01 },
    { MAP_SPROUT_TOWER_1F,             0x0F, 0x09, 0x1, 0x1, 0x0, 0x0, msg_0273_00039, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_UNION_CAVE_1F,               0x0E, 0x0F, 0x1, 0x1, 0x0, 0x0, msg_0273_00046, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2C, 0x01, 0x01 },
    { MAP_SLOWPOKE_WELL_ENTRANCE,      0x0D, 0x10, 0x1, 0x1, 0x0, 0x0, msg_0273_00047, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_ILEX_FOREST,                 0x0B, 0x10, 0x1, 0x1, 0x0, 0x0, msg_0273_00052, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x2D, 0x01, 0x01 },
    { MAP_NATIONAL_PARK,               0x0A, 0x08, 0x2, 0x2, 0x4, 0x4, msg_0273_00043, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x25, 0x02, 0x02 },
    { MAP_BELL_TOWER_1F,               0x0C, 0x06, 0x1, 0x1, 0x0, 0x0, msg_0273_00040, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_BURNED_TOWER_1F,             0x0B, 0x06, 0x1, 0x1, 0x0, 0x0, msg_0273_00042, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_MOUNT_MORTAR_1F_ENTRANCE,    0x0E, 0x07, 0x1, 0x1, 0x0, 0x0, msg_0273_00054, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_WHIRL_ISLANDS_1F,            0x07, 0x0D, 0x1, 0x1, 0x0, 0x0, msg_0273_00056, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x2E, 0x01, 0x01 },
    { MAP_TOHJO_FALLS,                 0x17, 0x0E, 0x1, 0x1, 0x0, 0x0, msg_0273_00061, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x28, 0x01, 0x01 },
    { MAP_VICTORY_ROAD_1F,             0x1C, 0x09, 0x1, 0x2, 0x0, 0x4, msg_0273_00059, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x25, 0x01, 0x02 },
    { MAP_VIRIDIAN_FOREST,             0x20, 0x07, 0x1, 0x1, 0x0, 0x0, msg_0273_00062, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x29, 0x01, 0x01 },
    { MAP_DIGLETT_CAVE,                0x20, 0x06, 0x1, 0x1, 0x0, 0x0, msg_0273_00033, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x28, 0x01, 0x01 },
    { MAP_DIGLETT_CAVE,                0x2A, 0x0B, 0x1, 0x1, 0x0, 0x0, msg_0273_00033, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1C, 0x2B, 0x01, 0x01 },
    { MAP_MOUNT_MOON,                  0x24, 0x05, 0x1, 0x1, 0x0, 0x0, msg_0273_00034, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x28, 0x01, 0x01 },
    { MAP_CERULEAN_CAVE_1F,            0x28, 0x05, 0x1, 0x1, 0x0, 0x0, msg_0273_00035, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_ROCK_TUNNEL_1F,              0x2C, 0x06, 0x1, 0x1, 0x0, 0x0, msg_0273_00036, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x29, 0x01, 0x01 },
    { MAP_ROUTE_10_POWER_PLANT_BROKEN, 0x2C, 0x07, 0x1, 0x1, 0x0, 0x0, msg_0273_00067, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x2A, 0x01, 0x01 },
    { MAP_SEAFOAM_ISLANDS_1F,          0x23, 0x11, 0x1, 0x1, 0x0, 0x0, msg_0273_00038, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x28, 0x01, 0x01 },
    { MAP_BATTLE_FRONTIER,             0x06, 0x08, 0x2, 0x2, 0x4, 0x4, msg_0273_00050, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x25, 0x02, 0x02 },
    { MAP_FUCHSIA_PAL_PARK_ENTRANCE,   0x25, 0x0E, 0x1, 0x1, 0x0, 0x0, msg_0273_00037, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_OLIVINE_LIGHTHOUSE_2F,       0x09, 0x0A, 0x1, 0x1, 0x0, 0x0, msg_0273_00048, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_PALLET,                      0x20, 0x0D, 0x1, 0x1, 0x0, 0x0, msg_0273_00010, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x03, 0x03 },
    { MAP_VIRIDIAN,                    0x1F, 0x09, 0x2, 0x2, 0x4, 0x4, msg_0273_00011, 0x02, 0x00, 0x00, 0x00, 0x00, 0x23, 0x20, 0x04, 0x04 },
    { MAP_PEWTER,                      0x20, 0x04, 0x2, 0x2, 0x4, 0x4, msg_0273_00012, 0x03, 0x00, 0x00, 0x00, 0x00, 0x23, 0x20, 0x04, 0x04 },
    { MAP_CERULEAN,                    0x28, 0x05, 0x2, 0x2, 0x4, 0x8, msg_0273_00013, 0x04, 0x00, 0x00, 0x00, 0x00, 0x12, 0x20, 0x04, 0x04 },
    { MAP_LAVENDER,                    0x2C, 0x09, 0x1, 0x1, 0x0, 0x0, msg_0273_00014, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x03, 0x03 },
    { MAP_VERMILION,                   0x28, 0x0B, 0x2, 0x2, 0x4, 0x4, msg_0273_00015, 0x06, 0x00, 0x00, 0x00, 0x00, 0x23, 0x20, 0x04, 0x04 },
    { MAP_CELADON,                     0x25, 0x09, 0x2, 0x2, 0x4, 0x4, msg_0273_00016, 0x07, 0x00, 0x00, 0x00, 0x00, 0x23, 0x20, 0x04, 0x04 },
    { MAP_FUCHSIA,                     0x25, 0x0E, 0x2, 0x2, 0x4, 0x8, msg_0273_00017, 0x08, 0x00, 0x00, 0x00, 0x00, 0x12, 0x20, 0x04, 0x04 },
    { MAP_CINNABAR_ISLAND,             0x20, 0x11, 0x1, 0x1, 0x0, 0x0, msg_0273_00018, 0x09, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x03, 0x03 },
    { MAP_SAFFRON,                     0x28, 0x08, 0x2, 0x2, 0x4, 0x4, msg_0273_00020, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x23, 0x20, 0x04, 0x04 },
    { MAP_NEW_BARK,                    0x15, 0x0E, 0x1, 0x1, 0x0, 0x0, msg_0273_00021, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x03, 0x03 },
    { MAP_CHERRYGROVE,                 0x10, 0x0E, 0x2, 0x1, 0x4, 0x0, msg_0273_00022, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x1A, 0x20, 0x04, 0x03 },
    { MAP_VIOLET,                      0x0E, 0x09, 0x2, 0x2, 0x4, 0x8, msg_0273_00023, 0x0D, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x20, 0x04, 0x04 },
    { MAP_AZALEA,                      0x0C, 0x10, 0x1, 0x1, 0x0, 0x0, msg_0273_00024, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x16, 0x20, 0x04, 0x03 },
    { MAP_CIANWOOD,                    0x05, 0x0C, 0x1, 0x2, 0x0, 0x4, msg_0273_00025, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x03, 0x20, 0x03, 0x04 },
    { MAP_GOLDENROD,                   0x09, 0x0C, 0x3, 0x2, 0x8, 0x4, msg_0273_00026, 0x10, 0x00, 0x00, 0x00, 0x00, 0x1E, 0x20, 0x05, 0x04 },
    { MAP_OLIVINE,                     0x08, 0x09, 0x2, 0x2, 0x4, 0x0, msg_0273_00027, 0x11, 0x00, 0x00, 0x00, 0x00, 0x06, 0x20, 0x04, 0x04 },
    { MAP_ECRUTEAK,                    0x0B, 0x06, 0x2, 0x2, 0x4, 0x8, msg_0273_00028, 0x12, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x20, 0x04, 0x04 },
    { MAP_MAHOGANY,                    0x10, 0x07, 0x1, 0x1, 0x0, 0x0, msg_0273_00029, 0x13, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x03, 0x03 },
    { MAP_BLACKTHORN,                  0x14, 0x06, 0x2, 0x2, 0x4, 0x8, msg_0273_00031, 0x14, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x20, 0x04, 0x04 },
    { MAP_INDIGO_PLATEAU,              0x1C, 0x08, 0x1, 0x1, 0x0, 0x0, msg_0273_00019, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_LAKE_OF_RAGE,                0x0F, 0x03, 0x3, 0x2, 0x8, 0x4, msg_0273_00030, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1E, 0x20, 0x05, 0x04 },
    { MAP_MOUNT_SILVER,                0x19, 0x0A, 0x1, 0x1, 0x0, 0x0, msg_0273_00057, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x28, 0x01, 0x01 },
    { MAP_RUINS_OF_ALPH_UNUSED,        0x0D, 0x0A, 0x1, 0x2, 0x0, 0x4, msg_0273_00045, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x20, 0x03, 0x04 },
    { MAP_SAFARI_ZONE_GATE,            0x02, 0x0A, 0x2, 0x2, 0x4, 0x4, msg_0273_00068, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x25, 0x02, 0x02 },
    { MAP_ROUTE_1,                     0x20, 0x0B, 0x1, 0x2, 0x0, 0x4, msg_0273_00070, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x2E, 0x01, 0x02 },
    { MAP_ROUTE_2,                     0x20, 0x08, 0x1, 0x1, 0x0, 0x0, msg_0273_00071, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x2A, 0x01, 0x01 },
    { MAP_ROUTE_3,                     0x22, 0x05, 0x2, 0x1, 0x4, 0x0, msg_0273_00072, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0x28, 0x02, 0x01 },
    { MAP_ROUTE_4,                     0x25, 0x05, 0x3, 0x1, 0x4, 0x0, msg_0273_00073, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1C, 0x28, 0x03, 0x01 },
    { MAP_ROUTE_5,                     0x28, 0x07, 0x1, 0x1, 0x0, 0x0, msg_0273_00074, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0x2C, 0x01, 0x01 },
    { MAP_ROUTE_6,                     0x28, 0x0A, 0x1, 0x1, 0x0, 0x0, msg_0273_00075, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1A, 0x2C, 0x01, 0x01 },
    { MAP_ROUTE_7,                     0x27, 0x09, 0x1, 0x1, 0x0, 0x0, msg_0273_00076, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x2C, 0x01, 0x01 },
    { MAP_ROUTE_8,                     0x2A, 0x09, 0x2, 0x1, 0x4, 0x0, msg_0273_00077, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1B, 0x2C, 0x02, 0x01 },
    { MAP_ROUTE_9,                     0x2A, 0x06, 0x2, 0x1, 0x4, 0x0, msg_0273_00078, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1D, 0x29, 0x02, 0x01 },
    { MAP_ROUTE_10,                    0x2C, 0x08, 0x1, 0x1, 0x0, 0x0, msg_0273_00079, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x2B, 0x01, 0x01 },
    { MAP_ROUTE_11,                    0x2B, 0x0B, 0x1, 0x1, 0x0, 0x0, msg_0273_00080, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1D, 0x2B, 0x01, 0x01 },
    { MAP_ROUTE_12,                    0x2C, 0x0A, 0x1, 0x3, 0x0, 0x4, msg_0273_00081, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1E, 0x2A, 0x01, 0x03 },
    { MAP_ROUTE_13,                    0x2A, 0x0D, 0x3, 0x1, 0x4, 0x0, msg_0273_00082, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1C, 0x2D, 0x03, 0x01 },
    { MAP_ROUTE_14,                    0x2A, 0x0E, 0x1, 0x2, 0x0, 0x4, msg_0273_00083, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1C, 0x2E, 0x01, 0x02 },
    { MAP_ROUTE_15,                    0x27, 0x0F, 0x3, 0x1, 0xC, 0x0, msg_0273_00084, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0x2F, 0x03, 0x01 },
    { MAP_ROUTE_16,                    0x23, 0x0A, 0x2, 0x1, 0x4, 0x0, msg_0273_00085, 0x00, 0x00, 0x00, 0x00, 0x00, 0x17, 0x28, 0x02, 0x01 },
    { MAP_ROUTE_17,                    0x23, 0x0B, 0x1, 0x4, 0x0, 0xC, msg_0273_00086, 0x00, 0x00, 0x00, 0x00, 0x00, 0x17, 0x29, 0x01, 0x04 },
    { MAP_ROUTE_18,                    0x23, 0x0F, 0x2, 0x1, 0x4, 0x0, msg_0273_00087, 0x00, 0x00, 0x00, 0x00, 0x00, 0x17, 0x2D, 0x02, 0x01 },
    { MAP_ROUTE_19,                    0x25, 0x10, 0x1, 0x2, 0x0, 0x4, msg_0273_00088, 0x00, 0x00, 0x00, 0x00, 0x00, 0x16, 0x2D, 0x01, 0x02 },
    { MAP_ROUTE_20,                    0x21, 0x11, 0x4, 0x1, 0x8, 0x0, msg_0273_00089, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x2E, 0x04, 0x01 },
    { MAP_ROUTE_21,                    0x20, 0x0E, 0x1, 0x3, 0x0, 0xC, msg_0273_00090, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x2D, 0x01, 0x03 },
    { MAP_ROUTE_22,                    0x1D, 0x0A, 0x2, 0x1, 0x4, 0x0, msg_0273_00091, 0x00, 0x00, 0x00, 0x00, 0x00, 0x15, 0x28, 0x02, 0x01 },
    { MAP_ROUTE_24,                    0x29, 0x04, 0x1, 0x1, 0x0, 0x0, msg_0273_00093, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x2A, 0x01, 0x01 },
    { MAP_ROUTE_25,                    0x29, 0x03, 0x4, 0x1, 0xC, 0x0, msg_0273_00094, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x29, 0x04, 0x01 },
    { MAP_ROUTE_26,                    0x1C, 0x0B, 0x1, 0x4, 0x0, 0xC, msg_0273_00095, 0x00, 0x00, 0x00, 0x00, 0x00, 0x14, 0x29, 0x01, 0x04 },
    { MAP_ROUTE_27,                    0x16, 0x0E, 0x6, 0x1, 0xF, 0x0, msg_0273_00096, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x2C, 0x06, 0x01 },
    { MAP_ROUTE_28,                    0x1A, 0x0A, 0x2, 0x1, 0x4, 0x0, msg_0273_00097, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x28, 0x02, 0x01 },
    { MAP_ROUTE_29,                    0x12, 0x0E, 0x3, 0x1, 0xC, 0x0, msg_0273_00098, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0B, 0x2E, 0x03, 0x01 },
    { MAP_ROUTE_30,                    0x11, 0x0B, 0x1, 0x3, 0x0, 0x4, msg_0273_00099, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x29, 0x01, 0x03 },
    { MAP_ROUTE_31,                    0x10, 0x0A, 0x2, 0x1, 0x1, 0x0, msg_0273_00100, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x28, 0x01, 0x01 },
    { MAP_ROUTE_32,                    0x0E, 0x0B, 0x1, 0x4, 0x0, 0xC, msg_0273_00101, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x28, 0x01, 0x04 },
    { MAP_ROUTE_33,                    0x0E, 0x10, 0x1, 0x1, 0x0, 0x0, msg_0273_00102, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2D, 0x01, 0x01 },
    { MAP_ROUTE_34,                    0x0B, 0x0E, 0x1, 0x3, 0x0, 0x4, msg_0273_00103, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x2B, 0x01, 0x02 },
    { MAP_ROUTE_35,                    0x0B, 0x0A, 0x1, 0x2, 0x0, 0x4, msg_0273_00104, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2D, 0x01, 0x02 },
    { MAP_ROUTE_36,                    0x0B, 0x09, 0x3, 0x1, 0x4, 0x0, msg_0273_00105, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2C, 0x03, 0x01 },
    { MAP_ROUTE_37,                    0x0C, 0x08, 0x1, 0x1, 0x0, 0x0, msg_0273_00106, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x2B, 0x01, 0x01 },
    { MAP_ROUTE_38,                    0x09, 0x07, 0x2, 0x1, 0x4, 0x0, msg_0273_00107, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x28, 0x02, 0x01 },
    { MAP_ROUTE_39,                    0x08, 0x07, 0x1, 0x2, 0x0, 0x4, msg_0273_00108, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x28, 0x01, 0x02 },
    { MAP_ROUTE_40,                    0x07, 0x0A, 0x1, 0x2, 0x0, 0x4, msg_0273_00109, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x2A, 0x01, 0x02 },
    { MAP_ROUTE_41,                    0x06, 0x0C, 0x2, 0x2, 0x4, 0x0, msg_0273_00110, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2C, 0x02, 0x02 },
    { MAP_ROUTE_42,                    0x0D, 0x07, 0x3, 0x1, 0x2, 0x0, msg_0273_00111, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2A, 0x03, 0x01 },
    { MAP_ROUTE_43,                    0x10, 0x05, 0x1, 0x2, 0x0, 0x4, msg_0273_00112, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x28, 0x01, 0x02 },
    { MAP_ROUTE_44,                    0x11, 0x07, 0x3, 0x1, 0x8, 0x0, msg_0273_00113, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x2A, 0x03, 0x01 },
    { MAP_ROUTE_45,                    0x14, 0x09, 0x1, 0x4, 0x0, 0x8, msg_0273_00114, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0D, 0x29, 0x01, 0x04 },
    { MAP_ROUTE_46,                    0x13, 0x0D, 0x1, 0x2, 0x0, 0x0, msg_0273_00115, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x2D, 0x01, 0x01 },
    { MAP_ROUTE_47,                    0x02, 0x0D, 0x3, 0x2, 0x8, 0x4, msg_0273_00116, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x29, 0x03, 0x02 },
    { MAP_ROUTE_48,                    0x02, 0x0C, 0x2, 0x1, 0x4, 0x0, msg_0273_00117, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x28, 0x02, 0x01 },
};
